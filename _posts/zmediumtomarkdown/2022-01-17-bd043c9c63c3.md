---
title: ã€Javascriptç­†è¨˜ã€‘this é€™æ˜¯å•¥
author: Martin
date: 2022-01-17T04:31:19.863+0000
last_modified_at: 2022-03-18T02:19:10.326+0000
categories: 
tags: []
description: åœ¨ä¸Šä¸€ç¯‡ä½¿ç”¨å»ºæ§‹å­å¿«é€Ÿå‰µé€ å‡ºè¨±å¤šç‰©ä»¶å¯¦ä¾‹æ™‚ï¼Œæœ‰ä½¿ç”¨this æŒ‡å‘å‘¼å« constructor function çš„ç©ºç‰©ä»¶ï¼Œæ›¾ç¶“ä¹Ÿåœ¨ä¸€èˆ¬çš„å‡½å¼ åŸ·è¡Œæ™‚ï¼Œç”¨ this æŒ‡å‘èª¿ç”¨ function çš„ç‰©ä»¶ã€‚é‚£åˆ°åº•é€™å€‹this æŒ‡çš„æ˜¯ä»€éº¼å‘¢ï¼Ÿ
image:
  path: assets/bd043c9c63c3/1*M82YESdij2lwJFDOUoy8oQ.jpeg
render_with_liquid: false
---

### ã€Javascriptç­†è¨˜ã€‘this é€™æ˜¯å•¥


![ä¾†æºï¼š [https://buzzorange\.com/techorange/2016/08/16/airbnb\-code\-review/](https://buzzorange.com/techorange/2016/08/16/airbnb-code-review/){:target="_blank"}](/assets/bd043c9c63c3/1*M82YESdij2lwJFDOUoy8oQ.jpeg)

ä¾†æºï¼š [https://buzzorange\.com/techorange/2016/08/16/airbnb\-code\-review/](https://buzzorange.com/techorange/2016/08/16/airbnb-code-review/){:target="_blank"}

åœ¨ä¸Šä¸€ç¯‡ä½¿ç”¨å»ºæ§‹å­å¿«é€Ÿå‰µé€ å‡ºè¨±å¤šç‰©ä»¶å¯¦ä¾‹æ™‚ï¼Œæœ‰ä½¿ç”¨ `this` æŒ‡å‘å‘¼å« constructor function çš„ç©ºç‰©ä»¶ï¼Œæ›¾ç¶“ä¹Ÿåœ¨ä¸€èˆ¬çš„å‡½å¼ åŸ·è¡Œæ™‚ï¼Œç”¨ `this` æŒ‡å‘èª¿ç”¨ function çš„ç‰©ä»¶ã€‚é‚£åˆ°åº•é€™å€‹ `this` æŒ‡çš„æ˜¯ä»€éº¼å‘¢ï¼Ÿ
### ç©¶ç«Ÿä»€éº¼æ˜¯ thisï¼Ÿ

JavaScript ä¸­çš„é—œéµå­— `this` æœƒ **åœ¨èª¿ç”¨æŸå€‹å‡½å¼æ™‚ï¼Œã€Œè‡ªå‹•åœ°ã€æ·»åŠ åˆ°è©²å‡½å¼ä¸­** ã€‚è€Œéš¨è‘—å‡½å¼åŸ·è¡Œç’°å¢ƒçš„ä¸åŒï¼Œ `this` æœƒç¶å®šåˆ°ä¸åŒçš„å°è±¡ã€‚
é€™è£¡è¬›çš„ç¶å®š \(binding\) æ˜¯ JavaScript è£¡çš„å¸¸è¦‹è¡“èªï¼Œæ„æ€æ˜¯ã€ŒæŒ‡å‘æŸå€‹ç‰©ä»¶ã€ï¼Œæ¯æ¬¡ä¸çŸ¥é“ `this` ç¶å®šåˆ°å“ªä¸€å€‹æ±è¥¿æ™‚ï¼Œæœ€æœ‰ç”¨çš„çµ•å°æ˜¯console å‡ºä¾†æœ€æ¸…æ¥šï¼
### ä¸åŒçš„ this ç¶å®šæ–¹å¼

`this` ç¶å®šæ–¹å¼æœ‰ä»¥ä¸‹å››ç¨®ï¼š
- éš±å¼ç¶å®š \(implicit binding\)
- é¡¯å¼ç¶å®š \(explicit binding\)
- é è¨­ç¶å®š \(default binding\)
- new é—œéµå­—ç¶å®š \(new binding\)

#### éš±å¼ç¶å®š \(Implicit Binding\) ï¼šå‡½å¼åŸ·è¡Œæ™‚ï¼Œæ˜¯èª°å‘¼å«äº†é€™å€‹å‡½å¼

éš±å¼ç¶å®š \(implicit binding\) ï¼Œä¹Ÿæ˜¯ **æœ€å¸¸é‡åˆ°çš„æƒ…å¢ƒ** ã€‚æ²¿ç”¨ä¹‹å‰æ‰‹æ©Ÿçš„ä¾‹å­ä¾†èªªæ˜ï¼Œè®“æˆ‘å€‘å…ˆå»ºç«‹ä¸€å€‹åç‚º `alphaPhoneX` çš„ç‰©ä»¶ï¼Œè£¡é¢åŒ…å« `name` , `price` å’Œ `features` å±¬æ€§ï¼Œä»¥åŠ `showPhoneInfo()` æ–¹æ³•ã€‚åœ¨ `showPhoneInfo()` è£¡ä½¿ç”¨äº† `this` é—œéµå­—
```
let alphaPhoneX = {
  name: 'AlphaPhoneX',   
  price: 14999,          
  features: ['long battery life', 'AI camera'], 
  showPhoneInfo: function() {                   
     console.log(`The price of ${this.name} is $${this.price}, which has the newest features such as ${this.features.join(', ')}.`)
  }
}
```

ç•¶æˆ‘å€‘å‘¼å« `alphaPhoneX` è£¡çš„ `showPhoneInfo` é€™å€‹æ–¹æ³•ï¼š
```
alphaPhoneX.showPhoneInfo()  // The price of AlphaPhoneX is $14999, which has the newest features such as long battery life, AI camera.
```

æ­¤æ™‚ `this` çš„éš±å¼ç¶å®šå°±æˆåŠŸè§¸ç™¼ï¼Œåœ¨ `showPhoneInfo` å‡½å¼è£¡çš„ `this` æŒ‡çš„å°±æ˜¯ `alphaPhoneX` ã€‚

å› æ­¤åœ¨å¤šæ•¸çš„æƒ…æ³ä¸‹ï¼Œ **å°æ•¸é» `.` å·¦é‚Šçš„é‚£å€‹ç‰©ä»¶å°±æ˜¯ `this` éš±å¼ç¶å®šçš„å°è±¡äº†** ï¼


![ä¾†æºï¼šalphacamp](/assets/bd043c9c63c3/1*4h6IuOuZBwHWdn1lo3Hqvg.png)

ä¾†æºï¼šalphacamp
#### é¡¯å¼ç¶å®š \(Explicit Binding\)

é›–ç„¶éš±å¼ç¶å®šçš„æ¢ä»¶å¾ˆæ˜ç¢ºï¼Œä½†ç•¶ç¨‹å¼ç¢¼è¤‡é›œèµ·ä¾†ï¼Œè¦å»çŒœé€™æ™‚çš„ `this` ç¶åˆ°èª°é‚„æ˜¯ä»¶éº»ç…©çš„äº‹ã€‚å› æ­¤ç•¶ä½ æƒ³è¦è‡ªè¡Œæ˜ç¢ºå®šç¾© `this` è¦ç¶å®šåœ¨èª°èº«ä¸Šï¼Œé€™å°±æ˜¯é¡¯å¼ç¶å®š \(explicit binding\)ã€‚
æœ‰ `call` , `apply` , æˆ– `bind` ä¸‰ç¨®æ–¹æ³•ï¼š
- callï¼šå…ˆå»ºç«‹ä¸€å€‹ä½¿ç”¨äº† `this` é—œéµå­—çš„å‡½å¼å’Œä¸€å€‹è®Šæ•¸

```
const showPhoneInfo = function () {
  console.log("'this' now refers to", this)
  console.log(`The price of ${this.name} is $${this.price}, which has the newest features such as ${this.features.join(', ')}.`)
}

let alphaPhoneX = {
  name: 'AlphaPhoneX',   
  price: 14999,          
  features: ['long battery life', 'AI camera'], 
}
```

æ¥è‘—ç”¨ `showPhoneInfo.call(alphaPhoneX)` å°±å¯ä»¥æ‰‹å‹•ç¶å®š `this` åœ¨ `alphaPhoneX` èº«ä¸Šã€‚


![ä¾†æºï¼šalphacamp](/assets/bd043c9c63c3/1*4X-sMlg8sJFVrHdPjf7bWQ.png)

ä¾†æºï¼šalphacamp

å¦‚æœå‡½å¼æœ¬èº«è¦å‚³å…¥åƒæ•¸ï¼Œåˆæƒ³è¦ä½¿ç”¨ `.call` ä¸»å‹•ç¶å®š `this` æ™‚ï¼Œåªéœ€æŠŠåƒæ•¸ä»£å…¥ `.call()` å¾Œé¢çš„åƒæ•¸ä¸­å³å¯ã€‚
```
const showPhoneInfo = function (ram, storage) {
//   console.log("'this' now refers to", this)
  console.log(`The price of ${this.name} with ${ram}GB and ${storage}GB is $${this.price}, which has the newest features such as ${this.features.join(', ')}.`)
}

showPhoneInfo.call(alphaPhoneX, 3, 64)
```
- applyï¼š `.apply()` çš„ä½¿ç”¨æ–¹å¼å’Œ `.call()` ä¸€æ¨£ï¼Œåªæ˜¯ç•¶å‡½å¼éœ€è¦ä»£å…¥åƒæ•¸æ™‚ï¼Œ `.apply()` **å¾Œé¢æ˜¯ä½¿ç”¨é™£åˆ—çš„æ–¹å¼ä¾†ä»£å…¥é€™äº›åƒæ•¸**

```
showPhoneInfo.apply(alphaPhoneX, [3, 64])
```


![ä¾†æºï¼šalphacamp](/assets/bd043c9c63c3/1*AYAf0k0kWvIwdzU_xvtOUw.png)

ä¾†æºï¼šalphacamp
- bindï¼šæœ€å¾Œ `.bind()` ä¹Ÿå¯ä»¥é”æˆç›¸åŒçµæœï¼Œå”¯ä¸€ä¸åŒçš„åœ°æ–¹æ˜¯ï¼Œ `.call()` èˆ‡ `.apply()` æœƒç›´æ¥åŸ·è¡Œè©²å‡½å¼ï¼Œä¸¦å›å‚³å‡½å¼çš„çµæœï¼Œè€Œ `.bind()` ä¸æœƒç›´æ¥åŸ·è¡Œå‡½å¼ï¼Œè€Œæ˜¯å›å‚³å®Œæˆç¶å®šçš„å‡½å¼ã€‚å› æ­¤æƒ³è¦å‡½å¼çš„èª¿ç”¨çµæœï¼Œéœ€è¦é¡å¤–åŸ·è¡Œå®ƒ

```
const showPhoneInfoOfAlphaPhoneX = showPhoneInfo.bind(alphaPhoneX)

// invoke the function
showPhoneInfoOfAlphaPhoneX(3, 64)
```
#### é è¨­ç¶å®š \(Default Binding\)

ä¸Šé¢è«‡åˆ°çš„éš±å¼ç¶å®š \(implicit binding\) å’Œé¡¯å¼ç¶å®š \(explicit binding\) ä¸­éƒ½å¯ä»¥æ¸…æ¥šçŸ¥é“åœ¨æŸå€‹å‡½å¼ä¸­ `this` æŒ‡ç¨±åˆ°çš„æ˜¯å“ªå€‹ç‰©ä»¶ï¼Œç„¶è€Œæœ‰äº›æƒ…æ³ä¸‹ï¼ŒJavaScript ä¸¦ä¸æ¸…æ¥šä½ çš„ `this` åˆ°åº•æŒ‡å‘èª°ï¼Œé€™æ™‚å€™å°±æœƒç›´æ¥ç¶å®šåˆ°å…¨åŸŸç‰©ä»¶ \(global object\) ä¸Šï¼Œåœ¨ç€è¦½å™¨çš„ç’°å¢ƒä¸‹å…¨åŸŸç‰©ä»¶æŒ‡çš„å°±æ˜¯ Window ç‰©ä»¶ã€‚ä¾‹å¦‚å¦‚æœç›´æ¥åœ¨å…¨åŸŸç’°å¢ƒä¸‹å¯« `console.log(this)` æ™‚ï¼Œå®ƒå°±ä¸æ¸…æ¥šé€™å€‹ `this` è¦ç¶åœ¨èª°èº«ä¸Šï¼Œæ‰€ä»¥å°±æœƒé è¨­ç¶è¨‚åœ¨ Window ç‰©ä»¶ \(å…¨åŸŸç‰©ä»¶\) ä¸Š


![](/assets/bd043c9c63c3/1*__sEzXgPnWmPa6A-Vj4V7g.png)


æˆ–æ˜¯ç›´æ¥åœ¨å…¨åŸŸå®£å‘Šä¸€å€‹å‡½å¼æ–¹æ³•ï¼ŒåŒæ™‚åˆåœ¨å…¨åŸŸç’°å¢ƒä¸‹ç›´æ¥åŸ·è¡Œå®ƒæ™‚ï¼ŒåŸæœ¬æŒ‰ç…§éš±å¼ç¶å®šçš„è¦å‰‡æ˜¯è¦å°‡ `this` æŒ‡å‘å‘¼å«æ­¤å‡½å¼æ™‚ `.` å·¦é‚Šçš„ç‰©ä»¶ï¼Œä½†é€™æ™‚å€™ `this` çš„å·¦é‚Šæ²’æœ‰ä»»ä½•ç‰©ä»¶ï¼Œå› æ­¤é è¨­çš„æƒ…æ³ä¸‹ï¼Œä¹Ÿæœƒç›´æ¥ç¶å®šåˆ° Window ç‰©ä»¶ \(å…¨åŸŸç‰©ä»¶\) ä¸Š


![](/assets/bd043c9c63c3/1*QGWnd_MD9azSwONMEKrqhA.png)


ğŸŒ åœ¨ç€è¦½å™¨çš„åŸ·è¡Œç’°å¢ƒä¸‹ï¼Œå…¨åŸŸç‰©ä»¶ \(global object\) æŒ‡çš„å°±æ˜¯åç‚º Window çš„ç‰©ä»¶ï¼›ä½†è‹¥åœ¨ Node\.js çš„åŸ·è¡Œç’°å¢ƒä¸‹ï¼Œå…¨åŸŸç‰©ä»¶å‰‡æœƒæŒ‡ç¨±åç‚º Global çš„ç‰©ä»¶ã€‚

ç‰¹åˆ¥è¦æ³¨æ„ä¸€é»ï¼šå¦‚æœåœ¨ç¨‹å¼ç¢¼ä¸­åŠ å…¥ â€œuse strictâ€ å®£å‘Šæˆåš´æ ¼æ¨¡å¼å¾Œï¼ŒåŸå…ˆé è¨­ç¶å®š `this` è‡³å…¨åŸŸç‰©ä»¶çš„è¡Œçˆ²ï¼Œæœƒè½‰è®Šæˆ `undefined` ã€‚
#### new é—œéµå­—ç¶å®š \(new Binding\)

æœ€å¾Œä¸€ç¨®æƒ…æ³æ˜¯ã€Œnew é—œéµå­—ç¶å®š \(new binding\) ã€ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€ç¯‡æ–‡ä¸­ä½¿ç”¨å»ºæ§‹å¼å‡½å¼ä¾†å»ºç«‹æ–°ç‰©ä»¶ï¼Œç”¨åˆ° `new` å»ºç«‹ç‰©ä»¶å¯¦ä¾‹æ™‚ï¼Œå‡½å¼å»ºæ§‹å¼ä¸­çš„ `this` å°±æœƒæŒ‡ç¨±åˆ°ä¸€å€‹æ–°çš„ **ç©ºç‰©ä»¶** ï¼Œæ–¼æ˜¯æˆ‘å€‘å°±å¯ä»¥å¾—åˆ°ä¸€å€‹æ–°çš„ç‰©ä»¶ï¼Œå†å°‡å±¬æ€§èˆ‡å€¼æ”¾é€²è©²ç©ºç‰©ä»¶ä¸­ã€‚
```
function SmartPhone(name, price, features){
  console.log(this)
    
  this.name = name
  console.log(this)
    
  this.price = price
  console.log(this)
    
  this.features = features
  console.log(this)
    
  this.showPhoneInfo = function() {
    console.log(`The price of ${this.name} is ${this.price}, which has the newest features such as ${this.features.join(', ')}.`)
  }
  console.log(this)
}

let alphaPhoneX = new SmartPhone('alphaPhoneX', 14999, ['long battery life', 'AI camera'])
```


![](/assets/bd043c9c63c3/1*k3wJZ63mELQUyaPbEpRk0w.png)


å†çœ‹ä¸€ä¾‹æ›´äº†è§£ä½¿ç”¨ `new` é—œéµå­—å»ºç«‹ç‰©ä»¶æ™‚ï¼Œthisçš„æŒ‡å‘èˆ‡ç‰©ä»¶å¯¦ä¾‹æ˜¯æ€éº¼è¢«æ‰“é€ å‡ºä¾†ï¼š
```
function Person( name, age, gender ){
   this.name = name;
   this.age = age;
   this.gender = gender;
   this.greeting = function(){
     console.log('Hello! My name is ' + this.name + '.');
   };
 } 
var kuro = new Person( 'Kuro', 32, 'male');
kuro.greeting();  // "Hello! My name is Kuro."
```

å‰é¢è¬›åˆ°èªªä½¿ç”¨ `new` å»ºç«‹ç‰©ä»¶å¯¦ä¾‹ï¼Œå‡½å¼å»ºæ§‹å¼ä¸­çš„ `this` å°±æœƒæŒ‡ç¨±åˆ°ä¸€å€‹æ–°çš„ **ç©ºç‰©ä»¶** ï¼Œå¯¦éš›çš„é‹ä½œæ©Ÿåˆ¶å¦‚ä¸‹ï¼š
```
function Person( name, age, gender ){
   // ç•¥ 
}  
var kuro = new Person( 'Kuro', 32, 'male');
/* 
===> var kuro = {}; 
===> Person.call(kuro, 'Kuro', 32, 'male'); 
*/
```

è£œå……ï¼šå¦‚æœæ˜¯é‡åˆ°ç®­é ­å‡½å¼ï¼ˆarrow functionï¼‰æ™‚ï¼Œthis ç¶å®šçš„æƒ…æ³å’Œç”¨é—œéµå­—function å»ºç«‹çš„å‡½å¼ä¸å¤ªä¸€æ¨£ã€‚é€™è£¡å…ˆè¬›çµè«–ï¼š


> ç®­é ­å‡½å¼çš„ this ç¶å®šåœ¨å®šç¾©æ™‚å°±å·²ç¶“è¢«æ±ºå®šï¼Œä¸æœƒéš¨è‘—ä½¿ç”¨çš„æƒ…æ³è€Œæœ‰æ‰€ä¸åŒ 





é€™å¥è©±æ˜¯ä»€éº¼æ„æ€å‘¢ï¼Ÿå›åˆ°æœ€ä¸€é–‹å§‹è¬›éš±å¼ç¶å®šæ™‚çš„ä¾‹å­ï¼Œåœ¨ä¸€èˆ¬å‡½å¼ `showPhoneInfo()` åŠç®­é ­å‡½å¼ `showPhoneInfoArr()` è£¡ä½¿ç”¨äº† `this` é—œéµå­—
```
let alphaPhoneX = {
  name: 'AlphaPhoneX',   
  price: 14999,          
  features: ['long battery life', 'AI camera'], 
  showPhoneInfo: function() {                   
     console.log(`The price of ${this.name} is $${this.price}, which has the newest features such as ${this.features.join(', ')}.`)
  },
  showPhoneInfoArr: () => {                   
     console.log(`The price of ${this.name} is $${this.price}, which has the newest features such as ${this.features.join(', ')}.`)
  }
}
```

ç•¶æˆ‘å€‘å‘¼å« `alphaPhoneX` è£¡çš„ `showPhoneInfo` åŠ `showPhoneInfoArr()` ï¼š
```
alphaPhoneX.showPhoneInfo()    // The price of AlphaPhoneX is $14999, which has the newest features such as long battery life, AI camera.
alphaPhoneX.showPhoneInfoArr() // The price of AlphaPhoneX is $14999, which has the newest features such as long battery life, AI camera.
```

å…©è€…çš„çµæœéƒ½æ˜¯ä¸€æ¨£çš„ï¼Œ `this` éƒ½ç¶å®šäº† `alphaPhoneX` ã€‚ä¹çœ‹ä¹‹ä¸‹ç®­é ­éŸ“å¼çš„ç¶å®šæƒ…æ³èˆ‡ä¸€èˆ¬å‡½å¼æ²’ä»€éº¼ä¸åŒã€‚ç„¶è€Œå†çœ‹çœ‹ä¸‹ä¾‹ï¼ˆåƒè€ƒè‡ª [PJ å¤§å¤§çš„éƒ¨è½æ ¼](https://pjchender.blogspot.com/2017/01/es6-arrow-function.html){:target="_blank"} ï¼‰ï¼š
```
let fn = function(){
  console.log(1,this.constructor.name);  // Object(data)
  setTimeout(function(){
    console.log(2,this.constructor.name) // Window
  },100);
}
// ç®­é ­å‡½å¼ Arrow function
let fn_arr = function(){
  console.log(3,this.constructor.name);  // Object(data)
  setTimeout(() => {
    console.log(4,this.constructor.name) // Object(data)
  },100);
}
let data = {}
```

å¾ç¯„ä¾‹ä¸­å¯ä»¥çœ‹å‡ºï¼Œä¸€èˆ¬å‡½å¼èˆ‡ç®­é ­å‡½å¼å†é€éé¡¯ç¤ºç¶å®š â€” call â€” ç¶å®šå‡½å¼ä¸­çš„ `this` æŒ‡å‘ `data` é€™å€‹ç‰©ä»¶ï¼Œæ‰€ä»¥åœ¨ï¼‘è·Ÿï¼“çš„ console çµæœæœƒå°å‡º `this` æŒ‡å‘çš„ç‰©ä»¶åç¨± â€” Object\(data\)ã€‚ç„¶è€Œåœ¨JS åŸ·è¡Œå®Œæ‰€æœ‰ **execution context** çš„å…§å®¹å¾Œï¼Œåœ¨ **event queue** å…§ç­‰å¾…è¢«åŸ·è¡Œçš„ä¸€èˆ¬å‡½å¼èˆ‡ç®­é ­å‡½å¼çš„setTimeout å‡½å¼ `this` æŒ‡å‘çš„å°è±¡å»ä¸ä¸€æ¨£ï¼

ä¸€èˆ¬å‡½å¼åœ¨åŸ·è¡Œ setTimeout å‡½å¼çš„æ™‚å€™ï¼Œç’°å¢ƒå·²ç¶“è®Šæˆ global environment
ï¼Œå› æ­¤ï¼’console çµæœæœƒå°å‡ºç€è¦½å™¨çš„å…¨åŸŸç’°å¢ƒ â€” windowï¼›ç„¶è€Œç®­é ­å‡½å¼çš„this æŒ‡å®šæƒ…æ³åœ¨å®šç¾©æ™‚å°±å›ºå®šäº†ï¼Œä¸æœƒéš¨è‘—ä½¿ç”¨çš„ç’°å¢ƒè€Œå½±éŸ¿ï¼Œå› æ­¤é€™å€‹ this æ‰€æŒ‡ç¨±çš„å°è±¡ä¸æœƒæ”¹è®Šï¼Œä¾ç„¶æ˜¯ data é€™å€‹ objectã€‚

åƒè€ƒè³‡æ–™ï¼š [éµäººè³½](https://ithelp.ithome.com.tw/articles/10193747){:target="_blank"}



_[Post](https://medium.com/@martin87713/javascript%E7%AD%86%E8%A8%98-this-%E9%80%99%E6%98%AF%E5%95%A5-bd043c9c63c3){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}._
