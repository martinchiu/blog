---
title: 【程式心法】關注點分離＿MVC架構
author: Martin
date: 2021-12-20T09:53:41.345+0000
last_modified_at: 2021-12-20T09:53:41.345+0000
categories: Reborn
tags: [Reborn]
description: 

render_with_liquid: false
---

## 【程式心法】關注點分離＿MVC架構

在學習到2–3尾聲時，我漸漸明白在學期初提到的關注點分離與MVC設計模式的概念，一開始只是字面上了解關注點分離的概念：


> 在應用程式開發的領域裡，相當重視「關注點分離 \(separation of concerns, SOC\) 」的設計原則，從字面上的意思，就是把整個應用程式分拆成不同功能層 \(layer\) 或程式碼模組 \(module\)，每個區塊有各自的關注點，彼此分工合作。 





> 從觀念上來說，你可以想像應用程式就像是一家公司，若我打造一個電子商務平臺，就像是營運一家貿易公司。想要打造這樣一家公司，就需要不同部門的員工各司其職，如：主管、財務、物流、客服、門巿業務⋯⋯等等。 





> 各部門需要聚焦在各自最重視的關注點才能心無旁鶩地達成任務，過程中再透過會議等形式來交流情報，以合力達成共同目標。 





一開始將express 框架引入主程式app\.js，實現出最粗糙的連線伺服器。隨著課程推進，版面越來越成熟，主程式行數也越來越多，功能也越來越雜，模板引擎、路由、資料庫相關的各種東西都放在主程式裡，也實際感受到這樣下去不是辦法，如果是一個要持續維護的專案，之後維護的人會非常辛苦，因此由衷地認為關注點分離有其必要！而落實這個概念的實作就是將「管理資料的功能」和「呈現視覺的功能」分離出主程式，達到Model\(資料\)、View\(畫面\)、Controller\(流程控制\)的架構，當然一個專案絕對不只有這些部分，光是到現在的階段就已經將路由獨立成一個檔案、額外的功能（如表單驗證、警示畫面）單獨出來，但MVC 只是代表一個軟體架構的設計模式，以下分別說明各自實際的功能：
### Model

直譯為「模型」，主要與資料庫進行溝通，並規範資料的格式\(Schema\)。因為實務上應用程式需要的資料不可能都放在專案的資料夾內，需要將資料獨立出來放在專門管理的資料庫，因此需要Model 層幫忙去資料庫裡取出必要的資料，把資料放進應用程式裡的某個程式物件，然後才能用 JavaScript 去操作該物件。

在２－３實際運用的狀況是將資料的Schema以及種子資料相關的程式放在models 這個資料夾；把跟mongodb 連線的mongoose程式碼放在config\(環境建置\)的資料夾
### View

直譯為「視圖」，主要是負責畫面的呈現，View 所管理的功能層叫作「表現層 \(presentation layer\)」，顧名思義是負責管理畫面的呈現，也就是 HTML 樣板 \(template\)。

在２－３實際運用的狀況是把樣版引擎\(template engine\)的模板\(layout\)及局部樣版\(partial template\)放在views 的資料夾
### Controller

直譯為「控制器」，主要負責接收網頁傳來的請求，分析對應的路由，再透過model 取得資料庫的資料，拿去給view 產生樣版，最後將回應傳回給瀏覽器。

可以把 Controller 想做是 MVC 架構的中間人，它決定了應用程式的工作流程 \(workflow\)，並且蒐集不同元件的工作結果，統一回傳給使用者。以下常見的設計問題，會由 Controller 來控制：
- 使用者是否需要先登入 \(認證\) 才可以看到網頁內容？
- 使用者是否只能閱讀資料，但不能修改或刪除？
- 使用者新增了資料之後，會重新導向至哪個頁面？


在２－３實際運用的狀況是將樣版引擎\(view\)在主程式內設置，取得跟資料庫連線的狀況\(model\)，將打包好的路由模組\(route\)引入主程式


![MVC的實作流程](/assets/f33b2d86880c/1*n2G-phyPGjy8WdaqVjrOqQ.png)

MVC的實作流程




